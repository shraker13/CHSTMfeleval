<?xml version="1.0" encoding="UTF-8"?><xsl:stylesheet version="2.0"  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"><xsl:output method="xml" indent="yes"  encoding="UTF-8" media-type="text/xml; charset=UTF-8"  omit-xml-declaration="yes"/><xsl:strip-space elements="*"/>


<xsl:template match="nodes"><xsl:result-document method="xml" href="internalEvaluationTable.csv">"Applicant","AIP","APS","CHF","CSHL","CPP","Col","Drexel","FI","HML","LCP","LHL","NYAM","New","OSU","PU","RAC","SMI","Penn","Tor","WFI","Yale"
<xsl:for-each select="."><xsl:for-each-group select="node" group-by="Applicant">"<xsl:value-of select="current-grouping-key()"/>",<xsl:for-each select="current-group()[1]"><xsl:sort select="AIP" data-type="number" order="descending"/><xsl:text>"</xsl:text><xsl:value-of select="../current-group()/AIP"/><xsl:text>",</xsl:text></xsl:for-each><xsl:for-each select="current-group()[1]"><xsl:sort select="APS" data-type="number" order="descending"/><xsl:text>"</xsl:text><xsl:value-of select="../current-group()/APS"/><xsl:text>",</xsl:text></xsl:for-each><xsl:for-each select="current-group()[1]"><xsl:sort select="CHF" data-type="number" order="descending"/><xsl:text>"</xsl:text><xsl:value-of select="../current-group()/CHF"/><xsl:text>",</xsl:text></xsl:for-each><xsl:for-each select="current-group()[1]"><xsl:sort select="CSHL" data-type="number" order="descending"/><xsl:text>"</xsl:text><xsl:value-of select="../current-group()/CSHL"/><xsl:text>",</xsl:text></xsl:for-each><xsl:for-each select="current-group()[1]"><xsl:sort select="CPP" data-type="number" order="descending"/><xsl:text>"</xsl:text><xsl:value-of select="../current-group()/CPP"/><xsl:text>",</xsl:text></xsl:for-each><xsl:for-each select="current-group()[1]"><xsl:sort select="Col" data-type="number" order="descending"/><xsl:text>"</xsl:text><xsl:value-of select="../current-group()/Col"/><xsl:text>",</xsl:text></xsl:for-each><xsl:for-each select="current-group()[1]"><xsl:sort select="Drexel" data-type="number" order="descending"/><xsl:text>"</xsl:text><xsl:value-of select="../current-group()/Drexel"/><xsl:text>",</xsl:text></xsl:for-each><xsl:for-each select="current-group()[1]"><xsl:sort select="FI" data-type="number" order="descending"/><xsl:text>"</xsl:text><xsl:value-of select="../current-group()/FI"/><xsl:text>",</xsl:text></xsl:for-each><xsl:for-each select="current-group()[1]"><xsl:sort select="HML" data-type="number" order="descending"/><xsl:text>"</xsl:text><xsl:value-of select="../current-group()/HML"/><xsl:text>",</xsl:text></xsl:for-each><xsl:for-each select="current-group()[1]"><xsl:sort select="LCP" data-type="number" order="descending"/><xsl:text>"</xsl:text><xsl:value-of select="../current-group()/LCP"/><xsl:text>",</xsl:text></xsl:for-each><xsl:for-each select="current-group()[1]"><xsl:sort select="LHL" data-type="number" order="descending"/><xsl:text>"</xsl:text><xsl:value-of select="../current-group()/LHL"/><xsl:text>",</xsl:text></xsl:for-each><xsl:for-each select="current-group()[1]"><xsl:sort select="NYAM" data-type="number" order="descending"/><xsl:text>"</xsl:text><xsl:value-of select="../current-group()/NYAM"/><xsl:text>",</xsl:text></xsl:for-each><xsl:for-each select="current-group()[1]"><xsl:sort select="New" data-type="number" order="descending"/><xsl:text>"</xsl:text><xsl:value-of select="../current-group()/New"/><xsl:text>",</xsl:text></xsl:for-each><xsl:for-each select="current-group()[1]"><xsl:sort select="OSU" data-type="number" order="descending"/><xsl:text>"</xsl:text><xsl:value-of select="../current-group()/OSU"/><xsl:text>",</xsl:text></xsl:for-each><xsl:for-each select="current-group()[1]"><xsl:sort select="PU" data-type="number" order="descending"/><xsl:text>"</xsl:text><xsl:value-of select="../current-group()/PU"/><xsl:text>",</xsl:text></xsl:for-each><xsl:for-each select="current-group()[1]"><xsl:sort select="RAC" data-type="number" order="descending"/><xsl:text>"</xsl:text><xsl:value-of select="../current-group()/RAC"/><xsl:text>",</xsl:text></xsl:for-each><xsl:for-each select="current-group()[1]"><xsl:sort select="SMI" data-type="number" order="descending"/><xsl:text>"</xsl:text><xsl:value-of select="../current-group()/SMI"/><xsl:text>",</xsl:text></xsl:for-each><xsl:for-each select="current-group()[1]"><xsl:sort select="Penn" data-type="number" order="descending"/><xsl:text>"</xsl:text><xsl:value-of select="../current-group()/Penn"/><xsl:text>",</xsl:text></xsl:for-each><xsl:for-each select="current-group()[1]"><xsl:sort select="Tor" data-type="number" order="descending"/><xsl:text>"</xsl:text><xsl:value-of select="../current-group()/Tor"/><xsl:text>",</xsl:text></xsl:for-each><xsl:for-each select="current-group()[1]"><xsl:sort select="WFI" data-type="number" order="descending"/><xsl:text>"</xsl:text><xsl:value-of select="../current-group()/WFI"/><xsl:text>",</xsl:text></xsl:for-each><xsl:for-each select="current-group()[1]"><xsl:sort select="Yale" data-type="number" order="descending"/><xsl:text>"</xsl:text><xsl:value-of select="../current-group()/Yale"/><xsl:text>"</xsl:text><xsl:text>&#xa;</xsl:text></xsl:for-each></xsl:for-each-group></xsl:for-each>

</xsl:result-document></xsl:template></xsl:stylesheet>	